# 串口通讯协议文档

## 概述

本文档详细描述了 IoT Dashboard 与 Arduino 设备之间的串口通讯协议。

## 协议特性

- 二进制协议，高效传输
- 包含校验和，确保数据完整性
- 起始和结束标记，便于包边界识别
- 可变长度数据载荷
- 双向通讯支持

## 数据包结构

每个数据包由以下字段组成：

```
+------------+--------+------+-------------+----------+----------+
| Start Byte | Length | Type | Data (0-n)  | Checksum | End Byte |
+------------+--------+------+-------------+----------+----------+
|   0xAA     |  1字节 | 1字节|   n字节     |   1字节  |   0x55   |
+------------+--------+------+-------------+----------+----------+
```

### 字段说明

1. **Start Byte (起始字节)**: 固定值 `0xAA`
2. **Length (长度)**: 1 字节 - Type + Data 的总字节数
3. **Type (命令类型)**: 1 字节 - 指示数据包的命令类型
4. **Data (数据载荷)**: 0-254 字节 - 可变长度的数据
5. **Checksum (校验和)**: 1 字节 - XOR 校验和
6. **End Byte (结束字节)**: 固定值 `0x55`

## 命令类型

| 命令 | 值 | 说明 | 数据格式 |
|------|-----|------|----------|
| GET_STATE | 0x01 | 获取设备状态 | 返回 6 字节状态数据 |
| SET_LIGHT | 0x02 | 设置灯光 | 1 字节: 0=关, 1=开 |
| SET_FAN_SPEED | 0x03 | 设置风扇速度 | 1 字节: 0-100 |
| GET_SENSOR_DATA | 0x04 | 获取传感器数据 | 返回 2 字节传感器数据 |
| RESET | 0x05 | 重置设备 | 无数据 |
| HEARTBEAT | 0x06 | 心跳包 | 无数据 |

详细协议说明请参见完整文档。
