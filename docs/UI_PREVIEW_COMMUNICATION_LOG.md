# 通讯日志界面预览

## 界面布局示意图

```
┌─────────────────────────────────────────────────────────────────────────┐
│  IoT Device Dashboard                                    [COM3] [Connect] │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                           │
│  ┌──────────────────────────┐  ┌──────────────────────────┐             │
│  │  🌡️ Environmental Sensors  │  │  📊 Device Status        │             │
│  │  Temperature: 23°C        │  │  ● Online                │             │
│  │  Humidity: 55%            │  │  🔋 Battery: 85%         │             │
│  └──────────────────────────┘  └──────────────────────────┘             │
│                                                                           │
│  ┌──────────────────────────┐  ┌──────────────────────────┐             │
│  │  💡 Light Control         │  │  🌀 Fan Control          │             │
│  │  [Turn ON/OFF]            │  │  Speed: 60%              │             │
│  └──────────────────────────┘  └──────────────────────────┘             │
│                                                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐ │
│  │                      通讯日志 Communication Log                      │ │
│  ├──────────────────────────────┬──────────────────────────────────────┤ │
│  │ 📤 发送的指令 (Sent Commands) │ 📥 接收的数据 (Received Data)        │ │
│  ├──────────────────────────────┼──────────────────────────────────────┤ │
│  │ ┌──────────────────────────┐ │ ┌──────────────────────────────────┐ │ │
│  │ │ 13:48:04.123             │ │ │ 13:48:04.145                     │ │ │
│  │ │ Set Fan Speed to 60%     │ │ │ Fan Speed Confirmed: 60%         │ │ │
│  │ │ AA 02 03 3C 3F 55        │ │ │ AA 07 01 17 37 01 3C 01 55 55   │ │ │
│  │ ├──────────────────────────┤ │ ├──────────────────────────────────┤ │ │
│  │ │ 13:48:02.001             │ │ │ 13:48:02.023                     │ │ │
│  │ │ Request Device State     │ │ │ State: Temp=23°C, Humid=55%...   │ │ │
│  │ │ AA 01 01 00 55           │ │ │ AA 07 01 17 37 01 3C 01 55 55   │ │ │
│  │ ├──────────────────────────┤ │ ├──────────────────────────────────┤ │ │
│  │ │ 13:48:00.001             │ │ │ 13:48:00.023                     │ │ │
│  │ │ Request Device State     │ │ │ State: Temp=23°C, Humid=55%...   │ │ │
│  │ │ AA 01 01 00 55           │ │ │ AA 07 01 17 37 00 00 01 55 55   │ │ │
│  │ └──────────────────────────┘ │ └──────────────────────────────────┘ │ │
│  └──────────────────────────────┴──────────────────────────────────────┘ │
│                                                                           │
├─────────────────────────────────────────────────────────────────────────┤
│  ℹ️ Status: Connected to COM3                                            │
└─────────────────────────────────────────────────────────────────────────┘
```

## 数据包格式图解

### 发送指令示例：Set Light ON

```
┌─────┬────────┬──────┬──────┬──────────┬─────┐
│ AA  │   02   │  02  │  01  │    01    │ 55  │
└─────┴────────┴──────┴──────┴──────────┴─────┘
  ↓       ↓       ↓      ↓        ↓       ↓
  │       │       │      │        │       │
起始    长度   命令   数据    校验和    结束
字节          类型   (ON)              字节
0xAA     2     0x02   0x01     0x01    0x55
       (1+1)  SET              (XOR)
              LIGHT
```

### 接收数据示例：Device State

```
┌─────┬────────┬──────┬──────┬──────┬──────┬──────┬──────┬──────┬──────────┬─────┐
│ AA  │   07   │  01  │  17  │  37  │  01  │  3C  │  01  │  55  │    XX    │ 55  │
└─────┴────────┴──────┴──────┴──────┴──────┴──────┴──────┴──────┴──────────┴─────┘
  ↓       ↓       ↓      ↓      ↓      ↓      ↓      ↓      ↓        ↓       ↓
  │       │       │      │      │      │      │      │      │        │       │
起始    长度   命令   温度   湿度   灯光   风扇   在线   电池    校验和    结束
字节          类型                                            字节
0xAA     7     0x01   23°C   55%   ON    60%   YES   85%     (XOR)   0x55
       (1+6)  GET
              STATE
```

## 通讯流程图

```
┌────────────┐                                    ┌────────────┐
│   用户界面  │                                    │  Arduino   │
│ (WinUI App) │                                    │  设备      │
└─────┬──────┘                                    └─────┬──────┘
      │                                                  │
      │ 1. 用户点击 "Turn ON"                            │
      │                                                  │
      │ 2. 发送: AA 02 02 01 01 55                      │
      ├─────────────────────────────────────────────────>│
      │    记录到"发送日志"（绿色面板）                   │
      │    [13:46:10.123] Set Light ON                  │
      │                                                  │
      │                                    3. Arduino 处理命令 │
      │                                       - 打开 LED       │
      │                                       - 准备响应       │
      │                                                  │
      │ 4. 接收: AA 07 01 17 37 01 00 01 55 55          │
      │<─────────────────────────────────────────────────┤
      │    记录到"接收日志"（蓝色面板）                   │
      │    [13:46:10.145] Light Confirmed: ON           │
      │                                                  │
      │ 5. 更新 UI                                       │
      │    - 灯光图标变亮                                 │
      │    - 按钮文字变为 "Turn OFF"                     │
      │                                                  │
      ▼                                                  ▼
```

## 实际运行截图说明

由于这是一个 WinUI 3 应用，需要在 Windows 环境中运行才能看到实际界面。运行后你会看到：

### 上半部分：设备控制面板
- 4 个卡片：环境传感器、设备状态、灯光控制、风扇控制
- 实时更新的温度、湿度、电池电量等数据
- 可点击的控制按钮和滑块

### 下半部分：通讯日志面板（新增功能）
- **左侧（绿色标题）**：所有发送的指令，按时间倒序排列
- **右侧（蓝色标题）**：所有接收的数据，按时间倒序排列
- 每条记录包含：
  - 灰色小字体的时间戳
  - 黑色正常字体的描述
  - 彩色等宽字体（Consolas）的十六进制数据

### 底部：状态栏
- 显示当前连接状态和提示信息

## 颜色方案

```
发送指令：
- 标题图标：绿色 (#4CAF50)
- 十六进制数据：绿色 (#4CAF50)
- 边框：绿色渐变

接收数据：
- 标题图标：蓝色 (#2196F3)
- 十六进制数据：蓝色 (#2196F3)
- 边框：蓝色渐变

共同元素：
- 背景：根据系统主题（明亮/暗黑模式自适应）
- 时间戳：次要文本色（灰色）
- 描述文字：主要文本色（黑色/白色）
- 分隔线：卡片边框色
```

## 响应式布局

- 两个面板平分宽度（各 50%）
- 高度固定为 300px，内容可滚动
- 在小窗口下自动添加滚动条
- 日志条目自动换行，不会被截断

## 动画效果

虽然当前版本没有动画，但 WinUI 3 默认提供了：
- 列表项淡入效果
- 平滑滚动
- 悬停高亮

---

**提示**：要查看实际效果，请在 Windows 10/11 系统上运行此应用并连接 Arduino 设备。
